version: "3.8"
services:
    backend:
        build: 
            context: .
            args:
                INSTALL_DEV: "true"
        ports:
            - "80:80"
        volumes:
            - .:/app
        command: /start-reload.sh
        depends_on:
            - db

    db:
        image: postgres:12
        volumes:
            - app-db-data:/var/lib/postgresql/data/pgdata
        env_file:
            - .env
        environment:
            - PGDATA=/var/lib/postgresql/data/pgdata

    pgadmin:
        image: dpage/pgadmin4
        ports:
            - "5050:5050"
        depends_on:
            - db
        env_file: 
            - .env

volumes: 
    app-db-data:
